{% extends 'admin_dashboard.html' %}

{% block title %}{{ action }} Banner{% endblock %}

{% block content %}
<div class="ad-main-content">
    <div class="ad-page-header">
        <h1>{{ action }} Banner</h1>
        <a href="{% url 'banneredit' %}" class="ad-btn ad-btn-secondary">‚Üê Back to Banner Management</a>
    </div>

    <div class="ad-form-container">
        <div class="ad-card">
            <div class="ad-card-header">
                <h2>Banner Details</h2>
            </div>
            <div class="ad-card-body">
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <div class="ad-form-grid">
                        <div class="ad-form-group ad-full-width">
                            <label for="{{ form.title.id_for_label }}">Banner Title *</label>
                            {{ form.title }}
                            {% if form.title.errors %}
                                <div class="ad-error">{{ form.title.errors.0 }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="ad-form-group ad-full-width">
                            <label for="{{ form.image.id_for_label }}">Banner Image *</label>
                            {{ form.image }}
                            <small class="ad-help-text">{{ form.image.help_text }}</small>
                            {% if form.image.errors %}
                                <div class="ad-error">{{ form.image.errors.0 }}</div>
                            {% endif %}
                            {% if banner and banner.image %}
                                <div class="current-image">
                                    <label>Current Image:</label>
                                    <img src="{{ banner.image.url }}" alt="Current banner" class="current-image-preview">
                                </div>
                            {% endif %}
                        </div>
                        
                        <div class="ad-form-group ad-full-width">
                            <label for="{{ form.alt_text.id_for_label }}">Alt Text *</label>
                            {{ form.alt_text }}
                            <small class="ad-help-text">Describe what's in the image for accessibility</small>
                            {% if form.alt_text.errors %}
                                <div class="ad-error">{{ form.alt_text.errors.0 }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="ad-form-group ad-full-width">
                            <label for="{{ form.link_url.id_for_label }}">Link URL (Optional)</label>
                            {{ form.link_url }}
                            <small class="ad-help-text">URL to redirect when banner is clicked</small>
                            {% if form.link_url.errors %}
                                <div class="ad-error">{{ form.link_url.errors.0 }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="ad-form-group">
                            <label for="{{ form.order.id_for_label }}">Display Order</label>
                            {{ form.order }}
                            <small class="ad-help-text">Lower numbers appear first</small>
                            {% if form.order.errors %}
                                <div class="ad-error">{{ form.order.errors.0 }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="ad-form-group">
                            <label class="ad-checkbox-label">
                                {{ form.is_active }}
                                <span>Active (Show on website)</span>
                            </label>
                            {% if form.is_active.errors %}
                                <div class="ad-error">{{ form.is_active.errors.0 }}</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="ad-form-actions">
                        <button type="submit" class="ad-btn ad-btn-primary">{{ action }} Banner</button>
                        <a href="{% url 'banneredit' %}" class="ad-btn ad-btn-secondary">Cancel</a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Image Preview Section -->
        <div class="ad-card">
            <div class="ad-card-header">
                <h3>üîç Preview</h3>
            </div>
            <div class="ad-card-body">
                <div class="image-preview-container">
                    <div id="imagePreview" class="image-preview">
                        {% if banner and banner.image %}
                            <img src="{{ banner.image.url }}" alt="Banner preview">
                        {% else %}
                            <div class="no-image-placeholder">
                                <span>üì∑</span>
                                <p>Image preview will appear here</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.ad-form-container {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 30px;
    align-items: start;
}

.ad-form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 30px;
}

.ad-form-group.ad-full-width {
    grid-column: 1 / -1;
}

.ad-form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
    color: #495057;
}

.ad-checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.ad-help-text {
    display: block;
    margin-top: 5px;
    font-size: 12px;
    color: #6c757d;
}

.ad-error {
    color: #dc3545;
    font-size: 12px;
    margin-top: 5px;
}

.current-image {
    margin-top: 15px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 6px;
}

.current-image-preview {
    width: 100%;
    max-width: 300px;
    height: auto;
    border-radius: 4px;
    margin-top: 10px;
}

.image-preview-container {
    border: 2px dashed #dee2e6;
    border-radius: 8px;
    overflow: hidden;
}

.image-preview {
    min-height: 200px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.image-preview img {
    width: 100%;
    height: auto;
    max-height: 300px;
    object-fit: cover;
}

.no-image-placeholder {
    text-align: center;
    color: #6c757d;
    padding: 40px 20px;
}

.no-image-placeholder span {
    font-size: 48px;
    display: block;
    margin-bottom: 10px;
}

.ad-form-actions {
    display: flex;
    gap: 10px;
}

@media (max-width: 768px) {
    .ad-form-container {
        grid-template-columns: 1fr;
    }
    
    .ad-form-grid {
        grid-template-columns: 1fr;
    }
}
a:-webkit-any-link {
    text-decoration: none;
}
</style>

<script>
// Live image preview
document.addEventListener('DOMContentLoaded', function() {
    const imageInput = document.querySelector('#id_image');
    const imagePreview = document.querySelector('#imagePreview');
    
    if (imageInput) {
        imageInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                };
                reader.readAsDataURL(file);
            }
        });
    }
});
</script>
{% endblock %}