{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Answers - {{ test.title }}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: #f5f5f5; 
            margin: 0; 
            padding: 20px; 
        }
        .container { max-width: 1100px; margin: auto; }
        
        .header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 { font-size: 2em; margin: 0; }
        .header p { opacity: 0.9; margin-top: 10px; }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        .stat-card i { font-size: 2em; margin-bottom: 10px; }
        .stat-card h3 { margin: 10px 0 5px; font-size: 1.8em; }
        .stat-card p { color: #666; font-size: 14px; margin: 0; }

        .question {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 2px solid #f0f0f0;
            margin-bottom: 15px;
            padding-bottom: 10px;
        }
        .question-number {
            background: #667eea;
            color: white;
            padding: 10px 14px;
            border-radius: 50%;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }
        .question-status {
            font-weight: 600;
            padding: 8px 12px;
            border-radius: 8px;
        }
        .correct { background: #e8f5e9; color: #388e3c; }
        .wrong { background: #ffebee; color: #c62828; }
        .skipped { background: #f3e5f5; color: #7b1fa2; }

        .question-text {
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.05em;
            line-height: 1.6;
            color: #333;
        }

        .answer { 
            margin-bottom: 10px; 
            padding: 10px;
            border-radius: 8px;
            background: #f8f9fa;
        }
        .answer strong { 
            display: inline-block; 
            width: 140px; 
            color: #444; 
        }
        .answer.correct { 
            background: #e8f5e9; 
            color: #2e7d32; 
            border-left: 4px solid #388e3c;
        }
        .answer.wrong { 
            background: #ffebee; 
            color: #c62828; 
            border-left: 4px solid #c62828;
        }
        .answer.skipped { 
            background: #f3e5f5; 
            color: #6a1b9a; 
            border-left: 4px solid #7b1fa2;
        }

        .back-btn {
            display: inline-block;
            margin-top: 25px;
            background: linear-gradient(45deg, #2196f3, #1976d2);
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }
        .back-btn i { margin-right: 8px; }

        @media (max-width: 768px) {
            .summary {
                grid-template-columns: repeat(2, 1fr);
            }
            .answer strong {
                display: block;
                width: 100%;
                margin-bottom: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Review Answers - {{ test.title }}</h1>
            <p>Analyze your performance and learn from your mistakes.</p>
        </div>

        <div class="summary">
            <div class="stat-card">
                <i class="fa fa-check-circle" style="color: #2ecc71;"></i>
                <h3>{{ attempt.correct_answers }}</h3>
                <p>Correct Answers</p>
            </div>
            <div class="stat-card">
                <i class="fa fa-times-circle" style="color: #e74c3c;"></i>
                <h3>{{ attempt.wrong_answers }}</h3>
                <p>Wrong Answers</p>
            </div>
            <div class="stat-card">
                <i class="fa fa-minus-circle" style="color: #9b59b6;"></i>
                <h3>{{ skipped_questions }}</h3>
                <p>Skipped Questions</p>
            </div>
            <div class="stat-card">
                <i class="fa fa-percent" style="color: #3498db;"></i>
                <h3>{{ attempt.percentage_score|floatformat:1 }}%</h3>
                <p>Accuracy</p>
            </div>
        </div>

        {% for item in answers_with_context %}
        <div class="question">
            <div class="question-header">
                <span class="question-number">{{ forloop.counter }}</span>
                {% if item.student_answer.is_correct %}
                    <span class="question-status correct"><i class="fa fa-check"></i> Correct</span>
                {% elif item.student_answer.is_attempted %}
                    <span class="question-status wrong"><i class="fa fa-times"></i> Wrong</span>
                {% else %}
                    <span class="question-status skipped"><i class="fa fa-minus"></i> Skipped</span>
                {% endif %}
            </div>
            <div>
                <p class="question-text">{{ item.question.question_text|safe }}</p>
                <div class="answer correct">
                    <strong>Correct Answer:</strong> {{ item.correct_answer_display }}
                </div>
                <div class="answer {% if item.student_answer.is_correct %}correct{% elif item.student_answer.is_attempted %}wrong{% else %}skipped{% endif %}">
                    <strong>Your Answer:</strong> {{ item.student_answer_display }}
                </div>
            </div>
        </div>
        {% empty %}
        <div style="text-align: center; padding: 40px; background: white; border-radius: 15px;">
            <i class="fa fa-exclamation-triangle" style="font-size: 3em; color: #f39c12; margin-bottom: 15px;"></i>
            <p style="font-size: 1.2em; color: #666;">No answers found for this test.</p>
        </div>
        {% endfor %}

        <div style="text-align:center;">
            <a href="{% url 'front_exam_result' attempt.id %}" class="back-btn">
                <i class="fa fa-arrow-left"></i> Back to Results
            </a>
        </div>
    </div>
</body>
</html>
